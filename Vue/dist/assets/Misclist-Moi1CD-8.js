import{_ as ne,r as a,o as oe,n as J,a as re,c as ue,w as ie,b as r,d as n,e as s,f as h,g as T,h as L,i as w,F as D,j as M,t as v,S as ce,k as z,l as de,m as ve,E as W,p as pe,D as ge}from"./index-DZtL7KMC.js";const fe={style:{"margin-bottom":"10px"}},he={class:"grid"},me=["onClick"],_e={class:"card-title"},be={style:{display:"flex","align-items":"center"}},ye={class:"card-description"},ke={class:"card-description"},we={class:"card-description",style:{"margin-left":"15px"}},xe={class:"card-description"},Ee={key:1,class:"refresh-tip"},Te={key:0,class:"load-more-tip"},Le={key:1,class:"no-more-tip"},De={key:2,class:"pagination"},Me=["disabled"],Ce=["disabled"],He={class:"data-container"},Se={key:0,class:"data-row"},Ve={class:"key-label"},Ye={class:"value-content"},ze={class:"truncated-text"},C=10,Be={__name:"Misclist",setup(qe){const i=a([]),c=a(1),m=a(!0),b=a(!0),u=a(!0),d=a(null),g=a(!1),x=a(0),H=a(0),S=a(0),A=a(30),_=a(!1),G=a(60),f=a(!1),K=a(200);a(!1),a(!0);const B=a({name:"",type:"",address:"",port:"",username:"",password:"",database:""}),Q=()=>{pe.confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ge().then(e=>{W({type:"success",message:"删除成功"}),c.value=1,y(!0)})})};a({name:[{required:!0,message:"请输入名称",trigger:"blur"}],type:[{required:!0,message:"请输入类型",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],port:[{required:!0,message:"请输入端口",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],database:[{required:!0,message:"请输入数据库",trigger:"blur"}]});const X=e=>{let t=JSON.parse(e.data);if(!e.success){W(e.errorMessage);return}B.value=t,V.value=!0};a();const E=a(!1),Z=()=>{E.value=!0},ee=()=>{E.value=!1},q=()=>window.innerWidth<=768,V=a(!1),y=(e=!1)=>{e?g.value=!0:f.value=!0,c.value==1&&(i.value=[]),ce({page:c.value}).then(t=>{e?(i.value=t.data.items,c.value=1):i.value=[...i.value,...t.data.items],m.value=!1,g.value=!1,f.value=!1,console.log(i.value.length),i.value.length>=t.data.total&&(b.value=!1)})},Y=()=>{const e=!q();e!==u.value&&(e?(j(),R()):J(()=>{F(),P()})),u.value=e},N=()=>{if(m.value||f.value||!b.value||u.value)return;let e,t,o;if(q()){const p=d.value;if(!p)return;e=p.scrollTop,t=p.clientHeight,o=p.scrollHeight}else e=window.scrollY||document.documentElement.scrollTop,t=window.innerHeight,o=document.documentElement.scrollHeight;e+t>=o-K.value&&y()},O=e=>{if(m.value||u.value||g.value||f.value||E.value)return;const t=d.value;t&&t.scrollTop>0||(x.value=e.touches[0].clientY,_.value=!0,t.style.transition="none")},$=e=>{if(!_.value||m.value||u.value||g.value||f.value||E.value)return;H.value=e.touches[0].clientY;const t=H.value-x.value;if(t>0){e.preventDefault();const o=d.value;if(o){const p=t*.5;o.style.transform=`translateY(${p}px)`}}},I=e=>{if(!_.value||m.value||u.value||g.value||f.value)return;S.value=e.changedTouches[0].clientY;const t=S.value-x.value,o=d.value;if(!o){_.value=!1;return}o.style.transition="transform 0.3s ease-out",t>A.value?(g.value=!0,y(!0),o.style.transform=`translateY(${G.value}px)`,setTimeout(()=>{o.style.transform="translateY(0)",_.value=!1},1500)):(o.style.transform="translateY(0)",_.value=!1),x.value=0,H.value=0,S.value=0},F=()=>{const e=d.value;e&&e.addEventListener("scroll",N,{passive:!0})},P=()=>{const e=d.value;e&&(e.addEventListener("touchstart",O,{capture:!0,passive:!1}),e.addEventListener("touchmove",$,{capture:!0,passive:!1}),e.addEventListener("touchend",I,{capture:!0,passive:!0}))},j=()=>{const e=d.value;e&&e.removeEventListener("scroll",N)},R=()=>{const e=d.value;e&&(e.removeEventListener("touchstart",O),e.removeEventListener("touchmove",$),e.removeEventListener("touchend",I))};oe(()=>{Y(),y(),window.addEventListener("resize",Y),J(()=>{u.value||(F(),P())})}),re(()=>{u.value||(j(),R()),window.removeEventListener("resize",Y)});const te=ue(()=>{if(u.value){const e=(c.value-1)*C;return i.value.slice(e,e+C)}else return i.value});return ie(c,()=>{const e=(c.value-1)*C;i.value.length<e+C&&b.value&&y()}),(e,t)=>{const o=w("el-button"),p=w("el-text"),se=w("el-tag"),ae=w("el-divider"),le=w("el-dialog");return n(),r("div",{class:"container",ref_key:"containerRef",ref:d},[s("div",fe,[T(o,{type:"danger",onClick:Q},{default:L(()=>t[3]||(t[3]=[z("清空日志")])),_:1,__:[3]})]),s("div",he,[(n(!0),r(D,null,M(te.value,l=>(n(),r("div",{key:l.id,class:"card"},[(n(),r("svg",{t:"1750044198871",onClick:U=>X(l),class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3441",width:"32",height:"32"},t[4]||(t[4]=[s("path",{d:"M298.666667 341.333333h384v42.666667H298.666667v-42.666667z m0 128h298.666666v42.666667H298.666667v-42.666667z m0 128h298.666666v42.666667H298.666667v-42.666667zM170.666667 128h682.666666v554.666667h42.666667V106.517333c0-11.52-9.557333-21.184-21.333333-21.184H149.333333c-11.626667 0-21.333333 9.557333-21.333333 21.376v810.581334C128 929.066667 137.557333 938.666667 149.333333 938.666667h490.666667v-42.666667H170.666667V128z m469.333333 576.042667c0-11.797333 9.728-21.376 21.376-21.376H896L640 938.666667V704.042667z m153.002667 21.290666H682.666667v110.336L793.002667 725.333333z",fill:"#3D3D3D","p-id":"3442"},null,-1)]),8,me)),s("h2",_e,[T(p,{"line-clamp":"2"},{default:L(()=>[z(v(l.content),1)]),_:2},1024)]),s("div",be,[s("div",null,[s("p",ye,"数据源："+v(l.sourceDatabase),1),s("p",ke,"同步库："+v(l.targetDatabase),1)]),s("p",we,"数据表："+v(l.tableName),1)]),s("p",xe,"同步时间："+v(l.syncTime),1),T(se,{type:l.success?"success":"danger",style:{position:"absolute",bottom:"30px",right:"10px"}},{default:L(()=>[z(v(l.success?"成功":"失败"),1)]),_:2},1032,["type"])]))),128)),m.value?(n(),r(D,{key:0},M(3,l=>s("div",{key:"loading-"+l,class:"card skeleton"},t[5]||(t[5]=[s("div",{class:"skeleton-line short"},null,-1),s("div",{class:"skeleton-line"},null,-1),s("div",{class:"skeleton-line long"},null,-1)]))),64)):h("",!0),g.value?(n(),r("div",Ee,t[6]||(t[6]=[s("div",{class:"loading-icon"},null,-1),s("span",null,"刷新中...",-1)]))):h("",!0)]),f.value&&!u.value?(n(),r("div",Te,t[7]||(t[7]=[s("div",{class:"spinner"},null,-1),s("span",null,"加载更多...",-1)]))):h("",!0),!b.value&&i.value.length>0&&!u.value?(n(),r("div",Le,t[8]||(t[8]=[s("span",null,"已经到底啦~",-1)]))):h("",!0),u.value&&i.value.length>0?(n(),r("div",De,[s("button",{disabled:c.value===1,onClick:t[0]||(t[0]=l=>c.value--)},"上一页",8,Me),s("span",null,"第 "+v(c.value)+" 页",1),s("button",{disabled:!b.value,onClick:t[1]||(t[1]=l=>c.value++)},"下一页",8,Ce)])):h("",!0),T(le,{modelValue:V.value,"onUpdate:modelValue":t[2]||(t[2]=l=>V.value=l),title:"详情",onOpen:Z,onClose:ee},{default:L(()=>[s("div",He,[(n(!0),r(D,null,M(B.value,(l,U)=>(n(),r("div",{class:de(["data-card",{"even-row":U%2===0}])},[(n(!0),r(D,null,M(Object.keys(l),k=>(n(),r("div",{key:k,style:{padding:"5px"}},[k!=="updated_at"?(n(),r("div",Se,[s("span",Ve,v(k),1),s("span",Ye,[s("span",ze,v(l[k]),1)])])):h("",!0),k!=="updated_at"?(n(),ve(ae,{key:1,style:{margin:"5px 0"},"border-style":"dashed"})):h("",!0)]))),128))],2))),256))])]),_:1},8,["modelValue"])],512)}}},Oe=ne(Be,[["__scopeId","data-v-9a4ed1be"]]);export{Oe as default};
